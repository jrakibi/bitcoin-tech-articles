---
title: 'P2PK (Pay To Public Key)'
date: 2024-07-05T15:32:14Z
lastmod: '2024-07-06'
tags: ['bitcoin', 'privacy']
draft: false
summary: 'This article discusses the Pay To Public Key (P2PK) method used in Bitcoin transactions, highlighting its role in enhancing user privacy and security. Includes practical code examples and deep insights into its operation within the Bitcoin protocol.'
layout: PostSimple
---

P2PK was one of the earliest transaction types used in Bitcoin. Many of the early Bitcoin transactions attributed to Satoshi used P2PK.

This simple script type serves as an ideal foundation for understanding more complex scripts

**TLDR:** P2PK allows bitcoins to be sent directly to a _public key_. To spend the bitcoins, the recipient must provide a _valid signature_.

> [!NOTE]
> Despite being the simplest script, P2PK is not used as much as P2PKH.

To better understand how P2PK works, let's explore the **first transaction in Bitcoin history** from [block 170](https://mempool.space/tx/f4184fc596403b9d638783cf57adfe4c75c605f6356fbc91338530e9831e9e16), where _Satoshi Nakamoto_ sent 10 BTC to _Hal Finney_.

<TransactionsDisplay
  rawTx="0100000001c997a5e56e104102fa209c6a852dd90660a20b2d9c352423edce25857fcd3704000000004847304402204e45e16932b8af514961a1d3a1a25fdf3f4f7732e9d624c6c61548ab5fb8cd410220181522ec8eca07de4860a4acdd12909d831cc56cbbac4622082221a8768d1d0901ffffffff0200ca9a3b00000000434104ae1a62fe09c5f51b13905f07f06b99a2f7159b2225f374cd378d71302fa28414e7aab37397f554a7df5f142c21c1b7303b8a0626f1baded5c72a704f7e6cd84cac00286bee0000000043410411db93e1dcdb8a016b49840f8c53bc1eb68a382e97b1482ecad7b148a6909a5cb2e0eaddfb84ccf9744464f82e160bfa9b8b64f9d4c03f999b8643f656b412a3ac00000000"
  txTitle="Satoshi Sends 10 BTC to Hal Finney"
  highlightIndex={{ output: 0 }}
/>
> Note: You can Click on Inputs and Outputs above to view more details

The ability to lock and unlock coins is the mechanism by which we transfer bitcoin.  
**Locking** is giving bitcoins to someone.  
**Unlocking** is spending bitcoins that you have received.

<SvgDisplay src="/script-visualizer/lock_unlock2.svg" width="70%" height="auto" />

#### 1- Locking (ScriptPubKey):

When creating a P2PK transaction, Satoshi specifies **Hal's public key in the ScriptPubKey**.  
This script specifies the conditions that must be met to spend the bitcoins in the future, and it's placed within the output of a transaction.

**ScriptPubKey**: A P2PK locking script looks like this:

```
<Public key Hal> OP_CHECKSIG
```

To see this in action click on the **Output 1** of this Transaction too see the HEX and ASM representation of scriptPubKey

<TransactionsDisplay
  rawTx="0100000001c997a5e56e104102fa209c6a852dd90660a20b2d9c352423edce25857fcd3704000000004847304402204e45e16932b8af514961a1d3a1a25fdf3f4f7732e9d624c6c61548ab5fb8cd410220181522ec8eca07de4860a4acdd12909d831cc56cbbac4622082221a8768d1d0901ffffffff0200ca9a3b00000000434104ae1a62fe09c5f51b13905f07f06b99a2f7159b2225f374cd378d71302fa28414e7aab37397f554a7df5f142c21c1b7303b8a0626f1baded5c72a704f7e6cd84cac00286bee0000000043410411db93e1dcdb8a016b49840f8c53bc1eb68a382e97b1482ecad7b148a6909a5cb2e0eaddfb84ccf9744464f82e160bfa9b8b64f9d4c03f999b8643f656b412a3ac00000000"
  txId="f4184fc596403b9d638783cf57adfe4c75c605f6356fbc91338530e9831e9e16"
  txTitle="Satoshi Sends 10 BTC to Hal"
  highlightIndex={{ output: 1 }}
/>

- **OP_PUSHBYTES_65**: Indicates the length of the uncompressed public key (65 bytes)
- **0411db ... b412a3**: Represents Hal Finney's public key
- **OP_CHECKSIG**: This opcode, shown as "0xac" at the end of the HEX section above, verifies an ECDSA signature. It returns TRUE (OP_1) if the signature is valid, otherwise FALSE (OP_0).

<ExpandableSection
  title="Why Satoshi used Uncompressed pub key (65 bytes) ?"
  preview="Satoshi didn't know about compressed public keys ..."
>
Some have speculated that Satoshi was unaware of public key compression. It wasn't until Pieter Wuille discovered that the compressed SEC format existed in OpenSSL that people start using it.   
The advantage of using Compressed pub key is:   
their public keys are smaller => smaller transaction on the network => save block space

</ExpandableSection>

#### 2- Unlocking (ScriptSig)

To spend Bitcoin that Satoshi sent, Hal must provide a valid signature corresponding to the public key.

**ScriptSig:** P2PK Unlocking script looks like this:

```
<Signature Hal>
```

The scriptSig is the signature followed by SigHash byte as shown below

Click on **Input 1** of this transaction to see it in action:

<TransactionsDisplay
  rawTx="0100000001c997a5e56e104102fa209c6a852dd90660a20b2d9c352423edce25857fcd3704000000004847304402204e45e16932b8af514961a1d3a1a25fdf3f4f7732e9d624c6c61548ab5fb8cd410220181522ec8eca07de4860a4acdd12909d831cc56cbbac4622082221a8768d1d0901ffffffff0200ca9a3b00000000434104ae1a62fe09c5f51b13905f07f06b99a2f7159b2225f374cd378d71302fa28414e7aab37397f554a7df5f142c21c1b7303b8a0626f1baded5c72a704f7e6cd84cac00286bee0000000043410411db93e1dcdb8a016b49840f8c53bc1eb68a382e97b1482ecad7b148a6909a5cb2e0eaddfb84ccf9744464f82e160bfa9b8b64f9d4c03f999b8643f656b412a3ac00000000"
  txId="f4184fc596403b9d638783cf57adfe4c75c605f6356fbc91338530e9831e9e16"
  txTitle="Satoshi Sends 10 BTC to Hal"
  highlightIndex={{ input: 0 }}

/>

- **OP_PUSHBYTES_71**: Indicates the length of the signature (71 bytes).
- **30442 ... 1d9**: Hal's digital signature.
- **01**: SigHash type (SIGHASH_ALL)

#### 3- Validation

When a transaction is validated, the ScriptSig and ScriptPubKey are concatenated.

```
<signature Hal> <public key Hal> OP_CHECKSIG
```

The combined script will validate if the signature is valid, but fail if the signature is invalid.

The ScriptSig will only unlock the ScriptPubKey if the signature is valid for that public key. In other words, only someone with knowledge of the private key can produce a valid ScriptSig.

> [!NOTE]
> For the script to be valid, the top element of the stack must be **nonzero** after evaluation

You can play with this tool below to see step by step how we evaluate P2PK the stack

<ScriptStackVisualizer type="p2pk"></ScriptStackVisualizer>

<ExpandableSection
  title="Element VS Operation (Optional)"
  preview="In the previous example, Signature and Public Key are elements, while OP_CHECKSIG is an operation. To understand the difference between an Element and an Operation, read this."
>
**Elements:**  Data pushed onto the stack.

- **Type:** Byte strings (1 to 520 bytes).
- **Example:** `Signatures` or `public keys`

**Operations:** Commands that manipulate stack elements.

- **Type:** Consume and push elements.
- **Example:** `OP_DUP`, `OP_HASH160`, `OP_CHECKSIG`

### Example: OP_CHECKSIG

1. **OP_CHECKSIG**
   - **Function:** Verifies the ECDSA signature.
   - **Stack Operation:** Consumes 2 elements (pubkey and signature) and pushes 1 element (1 (TRUE) if valid, 0 (FALSE) if not).

### Summary Table

| Type          | Description                      | Example       | Consumption | Push            |
| ------------- | -------------------------------- | ------------- | ----------- | --------------- |
| **Element**   | Data for the stack               | DER Signature | N/A         | N/A             |
| **Operation** | Duplicates the top stack element | OP_DUP        | 0 elements  | 1 element       |
| **Operation** | Hashes the top stack element     | OP_HASH160    | 1 element   | 1 element       |
| **Operation** | Verifies a signature             | OP_CHECKSIG   | 2 elements  | 1 element (0/1) |

</ExpandableSection>

### Problems with P2PK

- **❌ Public keys are long:** Your username on a website is usually less than 20 characters, but a compressed public key is 33 bytes, and an uncompressed one is 65 bytes. When converted to Hex, the length doubles (compressed: 33 bytes × 2 = 66 characters; uncompressed: 65 bytes × 2 = 130 characters). This is because each byte is represented by two hexadecimal characters (8 bits = 2 × 4 bits)
- **❌ Larger public keys = larger UTXO:** These keys must be stored and indexed, requiring more resources for full nodes.
- **❌ If ECDSA is broken**, these outputs could be stolen because everyone can see the public key in the scriptPubKey field.

### Solving the Problems with p2pkh

P2PKH fixes this. Read the next topic to learn how

> [!IMPORTANT] > **Next Topic:** In the next topic, we'll dive deeper into the specifics of
> P2PKH.

---

### Exercise:

> [!WARNING] > **Note:** THIS EXERCISE IS NOT COMPLETE. (IGNORE THIS)

Create a ScriptSig that can unlock this ScriptPubKey. Make this ....

{' '}

<CodeEditor
  src="https://codesandbox.io/p/devbox/p2pkh-lvfxrl?embed=1&file=%2Fmain.py"
  title="P2PKH Code Example"
/>
